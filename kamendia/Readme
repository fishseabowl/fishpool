Re-implement the Kamendia protocol to improve the performance and security
